# DART



[TOC]



# Variable

> æ•°å­—ï¼ˆå°±åƒ Dart ä¸­çš„å…¶ä»–æ‰€æœ‰ä¸œè¥¿ä¸€æ ·ï¼‰éƒ½æ˜¯å¯¹è±¡

ç±»å‹æ¨æ–­

```dart
// å˜é‡ name çš„ç±»å‹è¢«æ¨æ–­ä¸º String
var name = 'Bob';
// æ˜¾å¼å£°æ˜
String name = 'Bob';
```

ä¸€ä¸ªå¯¹è±¡ä¸å—é™äºå•ä¸€ç±»å‹ï¼Œå¯ä»¥æŒ‡å®šä¸º `Object` ç±»å‹ï¼ˆæˆ–åœ¨å¿…è¦æ—¶ä½¿ç”¨ `dynamic`ï¼‰ã€‚

```dart
Object name = 'Bob';
```

## ç©ºå®‰å…¨

1. å¯ç©º

```dart
String? name  // Nullable type. Can be `null` or string.

String name   // Non-nullable type. Cannot be `null` but can be string.
```

2. å¿…é¡»åœ¨ä½¿ç”¨å˜é‡ä¹‹å‰å¯¹å…¶è¿›è¡Œåˆå§‹åŒ–ï¼ŒDart **ä¸ä¼šä¸ºéå¯ç©ºç±»å‹è®¾ç½®åˆå§‹å€¼**ï¼Œå®ƒå¼ºåˆ¶è¦æ±‚ä½ è®¾ç½®åˆå§‹å€¼ã€‚
3. ä½ ä¸èƒ½åœ¨å¯ç©ºç±»å‹çš„è¡¨è¾¾å¼ä¸Šè®¿é—®å±æ€§æˆ–è°ƒç”¨æ–¹æ³•ï¼ˆé™¤äº† `hashCode` æˆ– `toString()`ï¼‰

## é»˜è®¤å€¼

å…·æœ‰å¯ç©ºç±»å‹çš„æœªåˆå§‹åŒ–å˜é‡çš„åˆå§‹å€¼ä¸º `null` 

*é¡¶çº§å˜é‡å’Œç±»å˜é‡æ˜¯å»¶è¿Ÿåˆå§‹åŒ–çš„ï¼Œå®ƒä»¬ä¼šåœ¨ç¬¬ä¸€æ¬¡è¢«ä½¿ç”¨æ—¶å†åˆå§‹åŒ–*

## å»¶è¿Ÿåˆå§‹åŒ–å˜é‡

`late` ä¿®é¥°ç¬¦æœ‰ä¸¤ç§ç”¨æ³•ï¼š

- å£°æ˜ä¸€ä¸ªéç©ºå˜é‡ï¼Œä½†ä¸åœ¨å£°æ˜æ—¶åˆå§‹åŒ–ã€‚

  > é€šå¸¸ Dart çš„è¯­ä¹‰åˆ†æå¯ä»¥æ£€æµ‹éç©ºå˜é‡åœ¨ä½¿ç”¨ä¹‹å‰æ˜¯å¦è¢«èµ‹å€¼ï¼Œä½†æœ‰æ—¶ä¼šåˆ†æå¤±è´¥ã€‚å¸¸è§çš„ä¸¤ç§æƒ…å†µæ˜¯åœ¨**åˆ†æé¡¶çº§å˜é‡å’Œå®ä¾‹å˜é‡æ—¶**ï¼ŒDart é€šå¸¸æ— æ³•ç¡®å®šå®ƒä»¬æ˜¯å¦å·²è®¾å€¼ï¼Œå› æ­¤ä¸ä¼šå°è¯•åˆ†æã€‚

  ```dart
  // é¡¶çº§å˜é‡
  late int count;
  
  void main() {
    count = 1;
    print(count); // 1
  }
  ```

- å»¶è¿Ÿåˆå§‹åŒ–ä¸€ä¸ªå˜é‡

  - ï¼ˆDart æ¨æ–­ï¼‰å¯èƒ½ä¸éœ€è¦è¯¥å˜é‡ï¼Œå¹¶ä¸”åˆå§‹åŒ–å®ƒçš„å¼€é”€å¾ˆé«˜ã€‚
  - ä½ æ­£åœ¨åˆå§‹åŒ–ä¸€ä¸ªå®ä¾‹å˜é‡ï¼Œå®ƒçš„åˆå§‹åŒ–æ–¹æ³•éœ€è¦è°ƒç”¨ `this`ã€‚

  ```dart
  //åœºæ™¯1 
  // å¦‚æœ temperature å˜é‡ä»æœªè¢«ä½¿ç”¨ï¼Œåˆ™ readThermometer() è¿™ä¸ªå¼€é”€è¾ƒå¤§çš„å‡½æ•°ä¹Ÿæ°¸è¿œä¸ä¼šè¢«è°ƒç”¨ï¼š
  late String temperature = readThermometer(); // Lazily initialized.
  
  
  // åœºæ™¯2 å¯¹è±¡å°šæœªåˆå§‹åŒ– è°ƒç”¨äº†å¯¹è±¡æ–¹æ³•
  class Rectangle {
    final double width;
    final double height;
  
    // åªæœ‰åœ¨çœŸæ­£ä½¿ç”¨çš„æ—¶å€™æ‰ä¼šåˆå§‹åŒ–ï¼ˆä¸åŠ  late ä¼šå› ä¸º
    late final double area = _calculateArea();
    
    // ERROR: è¿™æ˜¯å› ä¸º _calculateArea æ˜¯ä¸€ä¸ªæœªç»‘å®šçš„å®ä¾‹æ–¹æ³•ï¼Œå®ƒéœ€è¦åœ¨å¯¹è±¡è¢«åˆ›å»ºä¹‹åæ‰èƒ½è¢«è°ƒç”¨
    // final double area = _calculateArea();
  
    Rectangle(this.width, this.height);
  
    double _calculateArea() {
      print('Calculating area...');
      return width * height;
    }
  }
  
  void main() {
    // å®ä¾‹åŒ–ä¸€ä¸ª Rectangle å¯¹è±¡
    Rectangle rect = Rectangle(10, 5);
  
    // æ­¤æ—¶ area å°šæœªè¢«è®¡ç®—ï¼Œå› ä¸ºå®ƒæ˜¯ late åˆå§‹åŒ–çš„
    print('Before accessing area');
  
    // ç¬¬ä¸€æ¬¡è®¿é—® area æ—¶æ‰ä¼šè®¡ç®—
    print('Area: ${rect.area}');
  
    // åç»­è®¿é—®ä¸å†é‡å¤è®¡ç®—
    print('Area again: ${rect.area}');
  }
  ```

  ## ç»ˆå€¼ (`final`) å’Œå¸¸é‡ (`const`)

> [å®ä¾‹å˜é‡](https://dart.cn/language/classes#instance-variables) å¯ä»¥æ˜¯ `final` ä½†ä¸èƒ½æ˜¯ `const`ã€‚

ä¸€ä¸ª final å˜é‡åªèƒ½è®¾ç½®ä¸€æ¬¡ï¼Œ`const` å˜é‡æ˜¯ç¼–è¯‘æ—¶å¸¸é‡ã€‚ï¼ˆ`const` å¸¸é‡éšå¼åŒ…å«äº† `final`ã€‚ï¼‰

`final` VS `const`

`final` å˜é‡åœ¨**è¿è¡Œæ—¶**è¢«åˆå§‹åŒ–

`const` å˜é‡åœ¨**ç¼–è¯‘æ—¶**å°±è¢«åˆå§‹åŒ–ä¸”æ˜¯ç¼–è¯‘æ—¶å¸¸é‡



> è™½ç„¶ `final` å¯¹è±¡ä¸èƒ½è¢«ä¿®æ”¹ï¼Œä½†**å®ƒçš„å­—æ®µå¯èƒ½å¯ä»¥è¢«æ›´æ”¹**ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œ`const` å¯¹è±¡åŠå…¶å­—æ®µä¸èƒ½è¢«æ›´æ”¹ï¼šå®ƒä»¬æ˜¯ **ä¸å¯å˜çš„**ã€‚

```dart
  final Map<String, Object> map = {
    "name": 'john',
  };
  // OK
  map['name'] = 'jake';
  
  
  const Map<String, Object> map = {
    "name": 'john',
  };
  // ERROR
  map['name'] = 'jake';
```



# Operator

| cascade | `..`  `?..` |
| ------- | ----------- |

> ä¸¥æ ¼æ¥è¯´ï¼Œçº§è”çš„â€œåŒç‚¹â€è¡¨ç¤ºæ³•ä¸æ˜¯è¿ç®—ç¬¦ã€‚å®ƒåªæ˜¯ Dart è¯­æ³•çš„ä¸€éƒ¨åˆ†ã€‚

cascade æ“ä½œç¬¦ `..` å¯ä»¥ç”¨æ¥å¯¹ä¸€ä¸ªå¯¹è±¡è¿ç»­è°ƒç”¨å¤šä¸ªæ–¹æ³•ï¼Œè€Œä¸éœ€è¦é‡å¤åœ°å¼•ç”¨è¯¥å¯¹è±¡ã€‚cascade æ“ä½œç¬¦ `..` åé¢è·Ÿçš„æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¯¥è¡¨è¾¾å¼è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åå¯¹è¿”å›çš„å¯¹è±¡è¿ç»­è°ƒç”¨å¤šä¸ªæ–¹æ³•ã€‚

```dart
List<int> list = [3, 2, 1];
list..remove(2)..sort();
print(list); // è¾“å‡º [1, 3]


var paint = Paint()
  ..color = Colors.black
  ..strokeCap = StrokeCap.round
  ..strokeWidth = 5.0;
// equivalent to 
var paint = Paint();
paint.color = Colors.black;
paint.strokeCap = StrokeCap.round;
paint.strokeWidth = 5.0;
```

`?..` æ“ä½œç¬¦æ˜¯å¯é€‰ cascade æ“ä½œç¬¦ï¼Œå®ƒä¸ `..` æ“ä½œç¬¦ç±»ä¼¼ï¼Œä½†æ˜¯å½“å·¦ä¾§çš„å¯¹è±¡ä¸º null æ—¶ï¼Œå®ƒä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè€Œæ˜¯ç›´æ¥è¿”å› nullã€‚

> å¯¹äºé‡‡ç”¨ä¸¤ä¸ªæ“ä½œæ•°çš„è¿ç®—ç¬¦ï¼Œ**æœ€å·¦è¾¹çš„æ“ä½œæ•°å†³å®šä½¿ç”¨å“ªç§æ–¹æ³•**ã€‚
>
> ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æœ‰ä¸€ä¸ª`Vector`å¯¹è±¡å’Œä¸€ä¸ª`Point`å¯¹è±¡ï¼Œåˆ™`aVector + aPoint`ä½¿ç”¨`Vector`åŠ æ³• ( `+` )ã€‚

```dart
querySelector('#confirm') // Get an object.
  ?..text = 'Confirm' // Use its members.
  ..classes.add('important')
  ..onClick.listen((e) => window.alert('Confirmed!'))
  ..scrollIntoView();

// equivalent to 
var button = querySelector('#confirm');
button?.text = 'Confirm';
button?.classes.add('important');
button?.onClick.listen((e) => window.alert('Confirmed!'));
button?.scrollIntoView();
```



```dart
// åµŒå¥—çº§è”
final addressBook = (AddressBookBuilder()
      ..name = 'jenny'
      ..email = 'jenny@example.com'
      ..phone = (PhoneNumberBuilder()
            ..number = '415-555-0100'
            ..label = 'home')
          .build())
    .build();
```

åœ¨**è¿”å›å®é™…å¯¹è±¡çš„å‡½æ•°ä¸Šæ„å»ºçº§è”æ—¶è¦å°å¿ƒ**ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹ä»£ç ä¼šå¤±è´¥ï¼š

```
var sb = StringBuffer();
sb.write('foo')
  ..write('bar'); // Error: method 'write' isn't defined for 'void'.
```

`sb.write()`è°ƒç”¨è¿”å› voidï¼Œå¹¶ä¸”æ‚¨æ— æ³•åœ¨`void`ä¸Šæ„é€ çº§è”ã€‚





| Operator | Meaning                                                      |
| -------- | ------------------------------------------------------------ |
| `as`     | ç±»å‹è½¬æ¢ï¼ˆä¹Ÿç”¨äºæŒ‡å®š[åº“å‰ç¼€](https://dart.cn/language/libraries#specifying-a-library-prefix): `import xxx as xxx`ï¼‰ |
| `is`     | å¦‚æœå¯¹è±¡å…·æœ‰æŒ‡å®šç±»å‹ï¼Œåˆ™ä¸º True                              |
| `is!`    | (IS NOT) å¦‚æœå¯¹è±¡æ²¡æœ‰æŒ‡å®šçš„ç±»å‹ï¼Œåˆ™ä¸º True                   |

å¦‚æœ`obj`å®ç°äº†`T`æŒ‡å®šçš„æ¥å£ï¼Œåˆ™`obj is T`çš„ç»“æœä¸º trueã€‚ä¾‹å¦‚ï¼Œ `obj is Object?`æ€»æ˜¯æ­£ç¡®çš„ã€‚

å¦‚æœæ‚¨ä¸ç¡®å®šè¯¥å¯¹è±¡çš„ç±»å‹ä¸º`T` ï¼Œè¯·åœ¨ä½¿ç”¨è¯¥å¯¹è±¡ä¹‹å‰ä½¿ç”¨`is T`æ£€æŸ¥ç±»å‹ã€‚

```
if (employee is Person) {
  // Type check
  employee.firstName = 'Bob';
}
```





| `~/` | Divide, returning an integer result (é™¤æ³•ï¼Œè¿”å›æ•´æ•°ç»“æœ) |
| ---- | -------------------------------------------------------- |

```dart
assert(5 ~/ 2 == 2); // Result is an int
```





è¦æµ‹è¯•ä¸¤ä¸ªå¯¹è±¡ x å’Œ y æ˜¯å¦è¡¨ç¤ºåŒä¸€äº‹ç‰©ï¼Œè¯·ä½¿ç”¨`==`è¿ç®—ç¬¦ã€‚(åœ¨æå°‘æ•°æƒ…å†µä¸‹ï¼Œæ‚¨éœ€è¦çŸ¥é“ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯å®Œå…¨ç›¸åŒçš„å¯¹è±¡ï¼Œè¯·ä½¿ç”¨[identical](https://api.dart.cn/stable/dart-core/identical.html)å‡½æ•°ã€‚)

ä»¥ä¸‹æ˜¯`==`è¿ç®—ç¬¦çš„å·¥ä½œåŸç†ï¼š

1. éƒ½ä¸º null è¿”å› trueï¼Œä¸€ä¸ªä¸º nullï¼Œè¿”å› false

2. å°† y ä½œä¸ºå‚æ•° è°ƒç”¨ x çš„ == æ–¹æ³•    ï¼ˆå³ `x.==(y)`)

   ```dart
   class MyClass {
     int value;
   
     MyClass(this.value);
   
     bool operator ==(Object other) {
       print('----- call MyClass == ----- ${other is OtherClass}');
       return other is OtherClass && value == other.value;
     }
   }
   
   class OtherClass {
     int value;
   
     OtherClass(this.value);
   
     bool operator ==(Object other) {
       print('----- call OtherClass == -----');
       return other is MyClass && value == other.value;
     }
   }
   
   void main() {
     MyClass myInstance = MyClass(1);
     OtherClass otherInstance = OtherClass(1);
   
     /**
      * ----- call MyClass == -----
      * true
     **/
     print(myInstance == otherInstance);
   
     /**
      * ----- call MyClass == -----
      * true
     **/
     print(otherInstance == myInstance);
   }
   
   
   ```



ä»…åœ¨åˆ†é…çš„å˜é‡ä¸º null æ—¶è¿›è¡Œåˆ†é…ï¼Œè¯·ä½¿ç”¨`??=`è¿ç®—ç¬¦

```dart
// Assign value to a
a = value;
// Assign value to b if b is null; otherwise, b stays the same
b ??= value;
```







| `>>>` | Unsigned shift right æ— ç¬¦å·å³ç§» |
| ----- | ------------------------------- |

```dart
final value = 0x22;
assert((value >>> 4) == 0x02); // Unsigned shift right
assert((-value >>> 4) > 0); // Unsigned shift right
```

```
æœ‰ç¬¦å·å³ç§»æ“ä½œå‰çš„å€¼ï¼š1111 1111 1111 1111ï¼ˆäºŒè¿›åˆ¶ï¼Œ-1 åè¿›åˆ¶ï¼‰
æœ‰ç¬¦å·å³ç§» 1 ä½åçš„å€¼ï¼š1111 1111 1111 1111ï¼ˆäºŒè¿›åˆ¶ï¼Œ-1 åè¿›åˆ¶ï¼‰
æ— ç¬¦å·å³ç§» 1 ä½åçš„å€¼ï¼š0111 1111 1111 1111ï¼ˆäºŒè¿›åˆ¶ï¼Œ2147483647 åè¿›åˆ¶ï¼‰
```





| spread ([See note](https://dart.cn/language/operators/#spread-operators)) | `...`  `...?` |
| ------------------------------------------------------------ | ------------- |

å¦‚æœæ‰©å±•è¿ç®—ç¬¦å³ä¾§çš„è¡¨è¾¾å¼å¯èƒ½ä¸º nullï¼Œåˆ™å¯ä»¥ä½¿ç”¨æ”¯æŒ null çš„æ‰©å±•è¿ç®—ç¬¦ ( `...?` ) æ¥é¿å…å¼‚å¸¸ï¼š

```
var list2 = [0, ...?list];
assert(list2.length == 1);
```



| `[]`  | Subscript access             | Represents a call to the overridable `[]` operator; example: `fooList[1]` passes the int `1` to `fooList` to access the element at index `1`<br /><br /> |
| ----- | ---------------------------- | ------------------------------------------------------------ |
| `?[]` | Conditional subscript access | ä¸`[]`ç±»ä¼¼ï¼Œä½†æœ€å·¦è¾¹çš„æ“ä½œæ•°å¯ä»¥ä¸º nullï¼›ç¤ºä¾‹ï¼š `fooList?[1]`å°† int `1`ä¼ é€’ç»™`fooList`ä»¥è®¿é—®ç´¢å¼•`1`å¤„çš„å…ƒç´ ï¼Œé™¤é`fooList`ä¸º nullï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹è¡¨è¾¾å¼è®¡ç®—ç»“æœä¸º nullï¼‰ |

> Map åªèƒ½ç”¨ [] è·å–å€¼





# Comments

## Documentation comments

æ–‡æ¡£æ³¨é‡Šæ˜¯ä»¥`///`æˆ–`/**`å¼€å¤´çš„å¤šè¡Œæˆ–å•è¡Œæ³¨é‡Šã€‚åœ¨è¿ç»­è¡Œä¸Šä½¿ç”¨`///`ä¸å¤šè¡Œæ–‡æ¡£æ³¨é‡Šå…·æœ‰ç›¸åŒçš„æ•ˆæœã€‚

```dart
class Food {}

class Activity {}


/// A domesticated South American camelid (Lama glama).
///
/// Andean cultures have used llamas as meat and pack
/// animals since pre-Hispanic times.
///
/// Just like any other animal, llamas need to eat,
/// so don't forget to [feed] them some [Food].
class Llama {
  String? name;

  /// Feeds your llama [food].
  ///
  /// The typical llama eats one bale of hay per week.
  void feed(Food food) {
    // ...
  }

  /// Exercises your llama with an [activity] for
  /// [timeLimit] minutes.
  void exercise(Activity activity, int timeLimit) {
    // ...
  }
}
```

åœ¨ç±»çš„ç”Ÿæˆæ–‡æ¡£ä¸­ï¼Œ `[feed]`æˆä¸º`feed`æ–¹æ³•çš„æ–‡æ¡£é“¾æ¥ï¼Œ `[Food]`æˆä¸º`Food`ç±»çš„æ–‡æ¡£é“¾æ¥ã€‚

è¦è§£æ Dart ä»£ç å¹¶ç”Ÿæˆ HTML æ–‡æ¡£ï¼Œå¯ä»¥ä½¿ç”¨ Dart çš„æ–‡æ¡£ç”Ÿæˆå·¥å…·[`dart doc`](https://dart.cn/tools/dart-doc) ã€‚æœ‰å…³ç”Ÿæˆæ–‡æ¡£çš„ç¤ºä¾‹ï¼Œè¯·å‚é˜…[Dart API æ–‡æ¡£ã€‚](https://api.dart.cn/stable)æœ‰å…³å¦‚ä½•æ„å»ºè¯„è®ºçš„å»ºè®®ï¼Œè¯·å‚é˜…[Effective Dartï¼šæ–‡æ¡£ã€‚](https://dart.cn/effective-dart/documentation)



# Metadata

ä½¿ç”¨å…ƒæ•°æ®æä¾›æœ‰å…³ä»£ç çš„é™„åŠ ä¿¡æ¯ã€‚å…ƒæ•°æ®æ³¨é‡Šä»¥å­—ç¬¦`@`å¼€å¤´ï¼Œåè·Ÿå¯¹ç¼–è¯‘æ—¶å¸¸é‡ï¼ˆä¾‹å¦‚`deprecated` ï¼‰çš„å¼•ç”¨æˆ–å¯¹å¸¸é‡æ„é€ å‡½æ•°çš„è°ƒç”¨ã€‚

> å…ƒæ•°æ®æ³¨é‡Šç”¨äºå‘ä»£ç æä¾›é™„åŠ ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯åœ¨ç¼–è¯‘æ—¶å¯ä»¥ä½¿ç”¨ï¼Œä½†åœ¨è¿è¡Œæ—¶ä¸ä¼šå½±å“ä»£ç çš„æ‰§è¡Œ

```dart
class Todo {
  final String who;
  final String what;

  const Todo(this.who, this.what);
}

// å¯¹å¸¸é‡æ„é€ å‡½æ•°çš„è°ƒç”¨
@Todo('Dash', 'Implement this function')
void doSomething() {
  print('Do something');
}
```

æ‰€æœ‰ Dart ä»£ç éƒ½å¯ä»¥ä½¿ç”¨å››ä¸ªæ³¨é‡Šï¼š 

- [`@Deprecated`](https://api.dart.cn/stable/dart-core/Deprecated-class.html) éœ€è¦æŒ‡å®šæ¶ˆæ¯ ï¼ˆè§ä¸‹æ–¹ä¾‹å­)
- [`@deprecated`](https://api.dart.cn/stable/dart-core/Deprecated-class.html) ä¸éœ€è¦æŒ‡å®šæ¶ˆæ¯ (è§ä¸‹æ–¹ä¾‹å­)
-  [`@override`](https://api.dart.cn/stable/dart-core/override-constant.html)
- [`@pragma`](https://api.dart.cn/stable/dart-core/pragma-class.html)

```dart
class Television {
  /// Use [turnOn] to turn the power on instead.
  @Deprecated('Use turnOn instead')
  void activate() {
    turnOn();
  }
  
  @deprecated
  void xxx () {}

  /// Turns the TV's power on.
  void turnOn() {...}
  // Â·Â·Â·
}
```





# Libraries & imports

`import`å’Œ`library`æŒ‡ä»¤å¯ä»¥å¸®åŠ©æ‚¨åˆ›å»ºæ¨¡å—åŒ–ä¸”å¯å…±äº«çš„ä»£ç åº“ã€‚åº“ä¸ä»…æä¾› APIï¼Œè€Œä¸”è¿˜æ˜¯ä¸€ä¸ªéšç§å•ä½ï¼š**ä»¥ä¸‹åˆ’çº¿ ( `_` ) å¼€å¤´çš„æ ‡è¯†ç¬¦ä»…åœ¨åº“å†…éƒ¨å¯è§**ã€‚*æ¯ä¸ª Dart æ–‡ä»¶ï¼ˆåŠå…¶éƒ¨åˆ†ï¼‰éƒ½æ˜¯ä¸€ä¸ª[åº“](https://dart.cn/tools/pub/glossary#library)*ï¼Œå³ä½¿å®ƒä¸ä½¿ç”¨[`library`](https://dart.cn/language/libraries/#library-directive)æŒ‡ä»¤ã€‚

åº“å¯ä»¥ä½¿ç”¨[åŒ…(packages)](https://dart.cn/guides/packages)æ¥åˆ†å‘ã€‚

## Using libraries

```dart
import 'dart:html';
```

- å†…ç½®åº“ï¼šç‰¹æ®Šçš„`dart:`scheme
- å…¶å®ƒï¼š
  - æ–‡ä»¶ç³»ç»Ÿè·¯å¾„
  - `package:`scheme ï¼ˆæŒ‡å®šç”±åŒ…ç®¡ç†å™¨ï¼ˆä¾‹å¦‚ pub å·¥å…·ï¼‰æä¾›çš„åº“ï¼‰

## Specifying a library prefix

> æ ‡è¯†ç¬¦å†²çª

```dart
import 'package:lib1/lib1.dart';
import 'package:lib2/lib2.dart' as lib2;
// Uses Element from lib1.
Element element1 = Element();

// Uses Element from lib2.
lib2.Element element2 = lib2.Element();
```

## Importing only part of a library 

```dart
// Import only foo.
import 'package:lib1/lib1.dart' show foo;

// Import all names EXCEPT foo.
import 'package:lib2/lib2.dart' hide foo;
```

## Lazily loading a library

æŒ‰éœ€åŠ è½½åº“

`dart`å·¥å…·**ä¸æ”¯æŒé™¤ Web ä¹‹å¤–çš„ç›®æ ‡çš„å»¶è¿ŸåŠ è½½**ã€‚å¦‚æœæ‚¨æ­£åœ¨æ„å»º Flutter åº”ç”¨ç¨‹åºï¼Œè¯·å‚é˜… **Flutter[å»¶è¿Ÿç»„ä»¶](https://docs.flutter.cn/perf/deferred-components)æŒ‡å—** ä¸­çš„å»¶è¿ŸåŠ è½½å®ç°ã€‚

è¦å»¶è¿ŸåŠ è½½åº“ï¼Œè¯·é¦–å…ˆä½¿ç”¨`deferred as`å¯¼å…¥å®ƒã€‚

```dart
import 'package:greetings/hello.dart' deferred as hello;
```

å½“æ‚¨éœ€è¦è¯¥åº“æ—¶ï¼Œè¯·ä½¿ç”¨è¯¥åº“çš„æ ‡è¯†ç¬¦è°ƒç”¨`loadLibrary()` 

```dart
Future<void> greet() async {
  await hello.loadLibrary();
  hello.printGreeting();
}
```

æ‚¨å¯ä»¥åœ¨åº“ä¸Š**å¤šæ¬¡è°ƒç”¨`loadLibrary()`** ï¼Œä¸ä¼šå‡ºç°é—®é¢˜ã€‚**è¯¥åº“ä»…åŠ è½½ä¸€æ¬¡**ã€‚

æ³¨æ„ç‚¹ï¼š

- å»¶è¿Ÿåº“çš„ç±»å‹ä¹Ÿæ˜¯å»¶è¿Ÿå¯¼å…¥ï¼ˆå»ºè®®ä½¿ç”¨å…¬å…±æ–‡ä»¶å¯¼å‡ºä»¥ä¾›ä¸¤è€…ä½¿ç”¨ï¼‰
- Dart éšå¼åœ°å°†`loadLibrary()`æ’å…¥åˆ°æ‚¨ä½¿ç”¨`deferred as namespace`å®šä¹‰çš„å‘½åç©ºé—´ä¸­ã€‚ `loadLibrary()`å‡½æ•°è¿”å›ä¸€ä¸ª[`Future`](https://dart.cn/libraries/dart-async#future) ã€‚

## The `library` directive

è¦æŒ‡å®šåº“çº§[æ–‡æ¡£æ³¨é‡Š](https://dart.cn/effective-dart/documentation#consider-writing-a-library-level-doc-comment)æˆ–[å…ƒæ•°æ®æ³¨é‡Š](https://dart.cn/language/metadata)ï¼Œè¯·å°†å®ƒä»¬é™„åŠ åˆ°æ–‡ä»¶å¼€å¤´çš„`library`å£°æ˜ä¸­ã€‚

```dart
/// A really great test library.
@TestOn('browser')
library;
```



# Built-in types

- [Numbers](https://dart.cn/language/built-in-types/#numbers) (`int`, `double`)
- [Strings](https://dart.cn/language/built-in-types/#strings) (`String`)
- [Booleans](https://dart.cn/language/built-in-types/#booleans) (`bool`)
- [Records](https://dart.cn/language/records) (`(value1, value2)`)
- [Lists](https://dart.cn/language/collections#lists) (`List`, also known as *arrays*)
- [Sets](https://dart.cn/language/collections#sets) (`Set`)
- [Maps](https://dart.cn/language/collections#maps) (`Map`)
- [Runes](https://dart.cn/language/built-in-types/#runes-and-grapheme-clusters) (`Runes`; often replaced by the `characters` API)
- [Symbols](https://dart.cn/language/built-in-types/#symbols) (`Symbol`)
- The value `null` (`Null`)



å…¶ä»–ä¸€äº›ç±»å‹åœ¨ Dart è¯­è¨€ä¸­ä¹Ÿå…·æœ‰ç‰¹æ®Šä½œç”¨ï¼š

- `Object` ï¼šé™¤`Null`ä¹‹å¤–çš„æ‰€æœ‰ Dart ç±»çš„è¶…ç±»ã€‚
- `Enum` ï¼šæ‰€æœ‰æšä¸¾çš„è¶…ç±»ã€‚
- `Iterable` ï¼šç”¨äº[for-in å¾ªç¯](https://dart.cn/libraries/dart-core#iteration)å’ŒåŒæ­¥[ç”Ÿæˆå™¨å‡½æ•°](https://dart.cn/language/functions#generators)ã€‚
- `Never` ï¼šè¡¨ç¤ºè¡¨è¾¾å¼æ°¸è¿œæ— æ³•æˆåŠŸå®Œæˆæ±‚å€¼ã€‚æœ€å¸¸ç”¨äºæ€»æ˜¯æŠ›å‡ºå¼‚å¸¸çš„å‡½æ•°ã€‚
- `dynamic` ï¼šè¡¨ç¤ºæ‚¨è¦ç¦ç”¨é™æ€æ£€æŸ¥ã€‚é€šå¸¸ä½ åº”è¯¥ä½¿ç”¨`Object`è¿˜æ˜¯`Object?`ã€‚
- `void` ï¼šè¡¨ç¤ºä»æœªä½¿ç”¨è¿‡æŸä¸ªå€¼ã€‚é€šå¸¸ç”¨ä½œè¿”å›ç±»å‹ã€‚



`int`: æ•´æ•°å€¼ä¸å¤§äº 64 ä½ï¼Œ[å…·ä½“å–å†³äºå¹³å°](https://dart.cn/guides/language/numbers)

[`double`](https://api.dart.cn/stable/dart-core/double-class.html): 64 ä½ï¼ˆåŒç²¾åº¦ï¼‰æµ®ç‚¹æ•°ï¼Œç”± IEEE 754 æ ‡å‡†æŒ‡å®š

æ‚¨è¿˜å¯ä»¥å°†å˜é‡å£°æ˜ä¸º `num`ã€‚å¦‚æœè¿™æ ·åšï¼Œå˜é‡å¯ä»¥åŒæ—¶å…·æœ‰æ•´æ•°å€¼å’ŒåŒç²¾åº¦å€¼ã€‚

```dart
num x = 1; // x can have both int and double values
x += 2.5;
```

å¿…è¦æ—¶ï¼Œæ•´æ•°å­—é¢é‡ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºåŒç²¾åº¦æ•°ï¼š

```dart
double z = 1; // Equivalent to double z = 1.0.
```

```dart
// String -> int
var one = int.parse('1');
assert(one == 1);

// String -> double
var onePointOne = double.parse('1.1');
assert(onePointOne == 1.1);

// int -> String
String oneAsString = 1.toString();
assert(oneAsString == '1');

// double -> String
String piAsString = 3.14159.toStringAsFixed(2);
assert(piAsString == '3.14');
```

## Strings

å¯ä»¥ä½¿ç”¨å•å¼•å·æˆ–åŒå¼•å·æ¥åˆ›å»ºå­—ç¬¦ä¸²

```dart
var s1 = 'Single quotes work well for string literals.';
var s2 = "Double quotes work just as well.";
var s3 = 'It\'s easy to escape the string delimiter.';
var s4 = "It's even easier to use the other delimiter.";
```

æ‚¨å¯ä»¥ä½¿ç”¨`${` *`expression`* `}`å°†è¡¨è¾¾å¼çš„å€¼æ”¾å…¥å­—ç¬¦ä¸²ä¸­ã€‚å¦‚æœè¡¨è¾¾å¼æ˜¯æ ‡è¯†ç¬¦ï¼Œåˆ™å¯ä»¥çœç•¥`{}` ã€‚

*ä¸ºäº†è·å–ä¸æŸä¸ªå¯¹è±¡å¯¹åº”çš„å­—ç¬¦ä¸²ï¼ŒDart è°ƒç”¨è¯¥å¯¹è±¡çš„`toString()`æ–¹æ³•*ã€‚

```dart
var s = 'string interpolation';

// ç­‰æ•ˆäº ${s}
assert('Dart has $s'); // Dart has string interpolation
assert('That deserves all caps. '
        '${s.toUpperCase()}' ==
    'That deserves all caps. '
        'STRING INTERPOLATION');
```

æ‚¨å¯ä»¥ä½¿ç”¨ç›¸é‚»çš„å­—ç¬¦ä¸²æ–‡å­—æˆ–`+`è¿ç®—ç¬¦è¿æ¥å­—ç¬¦ä¸²ï¼š

```dart
var s1 = 'a '
    'b'
assert(s1 == 'a b');

var s2 = 'a' + ' ' + 'b';
assert(s2 == 'a b');
```

è¦åˆ›å»ºå¤šè¡Œå­—ç¬¦ä¸²ï¼Œè¯·ä½¿ç”¨å¸¦æœ‰å•å¼•å·æˆ–åŒå¼•å·çš„ä¸‰å¼•å·ï¼š

```dart
var s1 = '''
You can create
multi-line strings like this one.
''';

var s2 = """This is also a
multi-line string.""";
```

You can create a "raw" string by prefixing it with `r`:

```dart
var s = r'In a raw string, not even \n gets special treatment.';
```

## Boolean

Dart çš„ç±»å‹å®‰å…¨æ„å‘³ç€æ‚¨ä¸èƒ½ä½¿ç”¨`if ( *nonbooleanValue* )`æˆ–`assert ( *nonbooleanValue* )`ç­‰ä»£ç ã€‚ç›¸åï¼Œæ˜¾å¼æ£€æŸ¥å€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```dart
// Check for an empty string.
var fullName = '';
assert(fullName.isEmpty);

// Check for zero.
var hitPoints = 0;
assert(hitPoints == 0);

// ... 
```

## Runes and grapheme clusters (ç¬¦æ–‡å’Œå­—ç´ ç°‡)

åœ¨ Dart ä¸­ï¼Œ[ç¬¦æ–‡](https://api.dart.cn/stable/dart-core/Runes-class.html)å…¬å¼€å­—ç¬¦ä¸²çš„ Unicode ä»£ç ç‚¹ã€‚æ‚¨å¯ä»¥ä½¿ç”¨[å­—ç¬¦åŒ…](https://pub-web.flutter-io.cn/packages/characters)æ¥æŸ¥çœ‹æˆ–æ“ä½œç”¨æˆ·æ„ŸçŸ¥çš„å­—ç¬¦ï¼Œä¹Ÿç§°ä¸º[Unicodeï¼ˆæ‰©å±•ï¼‰å­—ç´ ç°‡ã€‚](https://unicode.org/reports/tr29/#Grapheme_Cluster_Boundaries)

å¦‚æœéœ€è¦è¯»å–æˆ–å†™å…¥å•ä¸ª Unicode å­—ç¬¦ï¼Œè¯·ä½¿ç”¨å­—ç¬¦åŒ…åœ¨ String ä¸Šå®šä¹‰çš„`characters` getterã€‚è¿”å›çš„[`Characters`](https://pub-web.flutter-io.cn/documentation/characters/latest/characters/Characters-class.html)å¯¹è±¡æ˜¯ä½œä¸ºå­—ç´ ç°‡åºåˆ—çš„å­—ç¬¦ä¸²ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨å­—ç¬¦ API çš„ç¤ºä¾‹ï¼š

```dart
import 'package:characters/characters.dart';

void main() {
  var hi = 'Hi ğŸ‡©ğŸ‡°';
  print(hi);
  print('The end of the string: ${hi.substring(hi.length - 1)}');
  print('The last character: ${hi.characters.last}');
}
```

## Symbols

è¦è·å–æ ‡è¯†ç¬¦çš„ç¬¦å·ï¼Œè¯·ä½¿ç”¨ç¬¦å·æ–‡å­—ï¼Œå³`#`åè·Ÿæ ‡è¯†ç¬¦ï¼š

```dart
#radix
#bar
```

Symbols literals æ˜¯ç¼–è¯‘æ—¶å¸¸é‡ã€‚



# Records

åŒ¿åçš„ã€ä¸å¯å˜çš„èšåˆç±»å‹

- å›ºå®šå¤§å°çš„
- å¼‚æ„
- ç±»å‹åŒ–

## Record syntax

comma-delimited lists of named or positional fields

ä»¥**é€—å·åˆ†éš”**çš„  å‘½åæˆ–ä½ç½®å­—æ®µ åˆ—è¡¨

```dart
var record = ('first', a: 2, b: true, 'last');
```

```dart
(int, int) swap((int, int) record) {
  var (a, b) = record;
  return (b, a);
}
```

å‘½åå­—æ®µåœ¨å¤§æ‹¬å·å†…ï¼Œ**ä½äºæ‰€æœ‰ä½ç½®å­—æ®µä¹‹å**

```dart
// Record type annotation in a variable declaration:
({int a, bool b}) record;

// Initialize it with a record expression:
record = (a: 123, b: true);
```



The names of named fields in a record type are part of the [record's type definition](https://dart.cn/language/records/#record-types), or its *shape*. Two records with named fields with different names have different types:
è®°å½•ç±»å‹ä¸­å‘½åå­—æ®µçš„åç§°æ˜¯[è®°å½•ç±»å‹å®šä¹‰](https://dart.cn/language/records/#record-types)æˆ–å…¶*å½¢çŠ¶*çš„ä¸€éƒ¨åˆ†ã€‚å…·æœ‰ä¸åŒåç§°çš„å‘½åå­—æ®µçš„ä¸¤æ¡è®°å½•å…·æœ‰ä¸åŒçš„ç±»å‹ï¼š

```dart
({int a, int b}) recordAB = (a: 1, b: 2);
({int x, int y}) recordXY = (x: 3, y: 4);

// Compile error! These records don't have the same type.
// recordAB = recordXY;

(int x, int y, int z) point = (1, 2, 3);
(int r, int g, int b) color = (1, 2, 3);
print(point == color); // Prints 'true'.
point = color // OK

({int x, int y, int z}) point = (x: 1, y: 2, z: 3);
({int r, int g, int b}) color = (r: 1, g: 2, b: 3);
print(point == color); // Prints 'false'. Lint: Equals on unrelated types.
point = color // OK

```

åœ¨è®°å½•ç±»å‹æ³¨é‡Šä¸­ï¼Œæ‚¨è¿˜å¯ä»¥å‘½å*ä½ç½®*å­—æ®µï¼Œä½†è¿™äº›åç§°çº¯ç²¹ç”¨äºæ–‡æ¡£ï¼Œä¸ä¼šå½±å“è®°å½•çš„ç±»å‹ï¼š

```dart
// a båªæ˜¯ç”¨äºæ³¨é‡Šï¼Œå¯ä»¥çœç•¥
(int a, int b) recordAB = (1, 2);
(int x, int y) recordXY = (3, 4);

recordAB = recordXY; // OK.
```

è¿™ç±»ä¼¼äºå‡½æ•°å£°æ˜æˆ–å‡½æ•° typedef ä¸­çš„ä½ç½®å‚æ•°å¯ä»¥å…·æœ‰åç§°ï¼Œä½†è¿™äº›åç§°ä¸ä¼šå½±å“å‡½æ•°çš„ç­¾åã€‚



æ‚¨è¿˜å¯ä»¥ä½¿ç”¨å…¶[å‘½å fields](https://dart.cn/language/records/#record-fields)å’Œå†’å·`:`è¯­æ³•æ¥è§£æ„è®°å½•

```dart
({String name, int age}) userInfo(Map<String, dynamic> json)
// Â·Â·Â·
// Destructures using a record pattern with named fields:
final (:name, :age) = userInfo(json);
```





# Collections

## Lists

## Sets

è¦åˆ›å»ºç©ºé›†ï¼Œè¯·ä½¿ç”¨å‰é¢å¸¦æœ‰ç±»å‹å‚æ•°çš„`{}` ï¼Œæˆ–å°†`{}`åˆ†é…ç»™`Set`ç±»å‹çš„å˜é‡ï¼š

```dart
var names = <String>{};
// Set<String> names = {}; // This works, too.
// var names = {}; // Creates a map, not a set.
```

æ–¹æ³•

- `add`
- `addAll()`

```dart
var strings = ['1', '2'];
var elements = <String>{};
elements.add('fluorine');
elements.addAll(strings);

// ä½¿ç”¨.lengthè·å–é›†åˆä¸­çš„é¡¹ç›®æ•°
assert(elements.length == 3);
```

## Maps 

```dart
var gifts = {'first': 'partridge'};

// ä½¿ç”¨ä¸‹æ ‡èµ‹å€¼è¿ç®—ç¬¦ ( `[]=` ) å°†æ–°çš„é”®å€¼å¯¹æ·»åŠ åˆ°ç°æœ‰æ˜ å°„ï¼š
gifts['fourth'] = 'calling birds'; // Add a key-value pair

// ä½¿ç”¨ä¸‹æ ‡è¿ç®—ç¬¦ ( `[]` ) ä»æ˜ å°„ä¸­æ£€ç´¢å€¼ï¼š
assert(gifts['first'] == 'partridge');

// å¦‚æœæ‚¨æŸ¥æ‰¾åœ°å›¾ä¸­ä¸å­˜åœ¨çš„é”®ï¼Œåˆ™ä¼šå¾—åˆ°`null`ä½œä¸ºè¿”å›ï¼š
assert(gifts['fifth'] == null);

// ä½¿ç”¨`.length`è·å–æ˜ å°„ä¸­é”®å€¼å¯¹çš„æ•°é‡ï¼š
gifts['fourth'] = 'calling birds';
assert(gifts.length == 2);
```



## Operators

### Spread operators

```dart
var list = [1, 2, 3];
var list2 = [0, ...list];
assert(list2.length == 4);

// å¦‚æœæ‰©å±•è¿ç®—ç¬¦å³ä¾§çš„è¡¨è¾¾å¼å¯èƒ½ä¸º nullï¼Œåˆ™å¯ä»¥ä½¿ç”¨æ”¯æŒ null çš„æ‰©å±•è¿ç®—ç¬¦ ( ...? ) æ¥é¿å…å¼‚å¸¸ï¼š
var list2 = [0, ...?list];
assert(list2.length == 1);


```

### Control-flow operators

```dart
var nav = ['Home', 'Furniture', 'Plants', if (promoActive) 'Outlet'];

// if-case
// Dart ifè¯­å¥æ”¯æŒcaseå­å¥åè·Ÿæ¨¡å¼
var nav = ['Home', 'Furniture', 'Plants', if (login case 'Manager') 'Inventory'];

// ä»¥ä¸‹æ˜¯åœ¨å°†åˆ—è¡¨é¡¹æ·»åŠ åˆ°å¦ä¸€ä¸ªåˆ—è¡¨ä¹‹å‰ä½¿ç”¨é›†åˆæ¥æ“ä½œåˆ—è¡¨é¡¹çš„ç¤ºä¾‹ï¼š
var listOfInts = [1, 2, 3];
var listOfStrings = ['#0', for (var i in listOfInts) '#$i'];
assert(listOfStrings[1] == '#1');
```



# [æ³›å‹ (Generics) ](https://dart.cn/language/generics)

## Restricting the parameterized type

ä¸€ä¸ªå¸¸è§çš„ç”¨ä¾‹æ˜¯é€šè¿‡ä½¿å…¶æˆä¸º`Object`çš„å­ç±»å‹ï¼ˆè€Œä¸æ˜¯é»˜è®¤çš„[`Object?`](https://dart.cn/null-safety/understanding-null-safety#top-and-bottom) ï¼‰æ¥ç¡®ä¿ç±»å‹ä¸å¯ä¸º nullã€‚

```dart
class Foo<T extends Object> {
  // Any type provided to Foo for T must be non-nullable.
}
```







# Typedefs

ç±»å‹åˆ«åï¼ˆtype aliasï¼‰ç±»ä¼¼ TS ä¸­çš„ `type`

```dart
typedef IntList = List<int>;
IntList il = [1, 2, 3];
```

**å¯ä»¥æœ‰ç±»å‹å‚æ•°**ï¼š

```dart
typedef ListMapper<X> = Map<X, List<X>>;
Map<String, List<String>> m1 = {}; // Verbose.
ListMapper<String> m2 = {}; // Same thing but shorter and clearer.
```

åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨[å†…è”å‡½æ•°ç±»å‹](https://dart.cn/effective-dart/design#prefer-inline-function-types-over-typedefs)è€Œä¸æ˜¯å‡½æ•°çš„ typedefã€‚ç„¶è€Œï¼Œå‡½æ•° typedef ä»ç„¶æœ‰ç”¨ï¼š

```dart
typedef Compare<T> = int Function(T a, T b);

int sort(int a, int b) => a - b;

void main() {
  assert(sort is Compare<int>); // True!
}
```







# Patterns

ä¸€èˆ¬æ¥è¯´ï¼Œæ¨¡å¼å¯ä»¥**åŒ¹é…**å€¼ã€**è§£æ„**å€¼æˆ–ä¸¤è€…å…¼è€Œæœ‰ä¹‹ï¼Œå…·ä½“å–å†³äºæ¨¡å¼çš„ä¸Šä¸‹æ–‡å’Œå½¢çŠ¶

é¦–å…ˆï¼Œ*æ¨¡å¼åŒ¹é…*å…è®¸æ‚¨æ£€æŸ¥ç»™å®šå€¼æ˜¯å¦ï¼š

- Has a certain shape. å…·æœ‰ä¸€å®šçš„å½¢çŠ¶
  - è¿™é€šå¸¸æ¶‰åŠåˆ°å¯¹æ•°æ®ç»“æ„çš„å†…éƒ¨ç»„æˆè¿›è¡Œæ£€æŸ¥ï¼‰
- Is a certain constant. æ˜¯ä¸€å®šçš„å¸¸æ•°
- Is equal to something else. ç­‰äºå…¶ä»–ä¸œè¥¿
- Has a certain type. æœ‰ä¸€å®šçš„ç±»å‹ 
  - æ˜¯å¦å±äºç‰¹å®šçš„ç±»å‹ï¼Œè¿™ä¸æ£€æŸ¥å½¢çŠ¶ä¸åŒï¼Œå› ä¸ºå®ƒå…³æ³¨çš„æ˜¯å€¼çš„ç±»å‹ï¼Œè€Œä¸æ˜¯å€¼çš„å†…éƒ¨ç»“æ„ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥æ£€æŸ¥ä¸€ä¸ªå€¼æ˜¯å¦æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–ä¸€ä¸ªæ•´æ•°ï¼Œè€Œä¸å…³å¿ƒå®ƒçš„å…·ä½“å†…å®¹æˆ–ç»“æ„ã€‚

### 

æ‚¨å¯ä»¥åœ¨è§£æ„æ¨¡å¼ä¸­åµŒå¥—[ä»»ä½•ç±»å‹çš„æ¨¡å¼](https://dart.cn/language/pattern-types)ã€‚ä¾‹å¦‚ï¼Œæ­¤ case æ¨¡å¼åŒ¹é…å¹¶è§£æ„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸º`'a'`æˆ–`'b'`çš„äºŒå…ƒç´ åˆ—è¡¨ï¼š

```dart
switch (list) {
  case ['a' || 'b', var c]:
    print(c);
}
```



## Places patterns can appear 

- Local variable [declarations](https://dart.cn/language/patterns/#variable-declaration) and [assignments](https://dart.cn/language/patterns/#variable-assignment)
- [for and for-in loops](https://dart.cn/language/loops#for-loops)
- [if-case](https://dart.cn/language/branches#if-case) and [switch-case](https://dart.cn/language/branches#switch-statements)
- Control flow in [collection literals](https://dart.cn/language/collections#control-flow-operators)



### Variable declaration

```dart
// Declares new variables a, b, and c.
var (a, [b, c]) = ('str', [1, 2]);
```

### Variable assignment

```dart
var (a, b) = ('left', 'right');
(b, a) = (a, b); // Swap.
print('$a $b'); // Prints "right left".
```

### Switch è¯­å¥å’Œè¡¨è¾¾å¼

æ¯ä¸ª case å­å¥éƒ½åŒ…å«ä¸€ä¸ªæ¨¡å¼ã€‚è¿™é€‚ç”¨äº[switch è¯­å¥](https://dart.cn/language/branches#switch-statements)å’Œ[è¡¨è¾¾å¼](https://dart.cn/language/branches#switch-expressions)ï¼Œä»¥åŠ[if-case è¯­å¥](https://dart.cn/language/branches#if-case)ã€‚æ‚¨å¯ä»¥åœ¨æ¡ˆä¾‹ä¸­ä½¿ç”¨[ä»»ä½•ç±»å‹çš„å›¾æ¡ˆ](https://dart.cn/language/pattern-types)ã€‚

```dart
switch (obj) {
  // Matches if 1 == obj.
  case 1:
    print('one');

  // Matches if the value of obj is between the
  // constant values of 'first' and 'last'.
  case >= first && <= last:
    print('in range');

  // Matches if obj is a record with two fields,
  // then assigns the fields to 'a' and 'b'.
  case (var a, var b):
    print('a = $a, b = $b');

  default:
}
```

[é€»è¾‘æˆ–æ¨¡å¼](https://dart.cn/language/pattern-types#logical-or)å¯¹äºè®©å¤šä¸ª case åœ¨ switch è¡¨è¾¾å¼æˆ–è¯­å¥ä¸­å…±äº«ä¸€ä¸ªä¸»ä½“éå¸¸æœ‰ç”¨ï¼š

```dart
var isPrimary = switch (color) {
  Color.red || Color.yellow || Color.blue => true,
  _ => false
};



sealed class Shape {}

class Square implements Shape {
  final double length;
  Square(this.length);
}

class Circle implements Shape {
  final double radius;
  Circle(this.radius);
}

double calculateArea(Shape shape) => switch (shape) {
    Square(length: var l) => l * l,
    Circle(radius: var r) => math.pi * r * r
};

```

[Guard clauses](https://dart.cn/language/branches#guard-clause) evaluate an arbitrary condition as part of a case, **without exiting the switch if the condition is false** (like using an `if` statement in the case body would cause).

>  æ³¨ï¼šå½“ when ä¸æ»¡è¶³æ—¶ï¼Œè·³è¿‡å½“å‰ case ä¸”ä¸é€€å‡º switch

```dart
// Switch statement:
switch (something) {
  case somePattern when some || boolean || expression:
    //             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ Guard clause.
    body;
}

// Switch expression:
var value = switch (something) {
  somePattern when some || boolean || expression => body,
  //               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ Guard clause.
}

// If-case statement:
if (something case somePattern when some || boolean || expression) {
  //                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ Guard clause.
  body;
}
```

### For and for-in loops for 

```dart
Map<String, int> hist = {
  'a': 23,
  'b': 100,
};

for (var MapEntry(key: key, value: count) in hist.entries) {
  print('$key occurred $count times');
}

// ç®€åŒ–
for (var MapEntry(:key, value: count) in hist.entries) {
  print('$key occurred $count times');
}
```

